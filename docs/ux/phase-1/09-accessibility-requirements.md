# 09. Accessibility Requirements

> WCAG 2.1 AA を最低基準とし、すべてのユーザーが「記録する喜び」を体験できること

---

## 1. 対象基準

### 1.1 準拠レベル

| レベル | 対応 | 備考 |
|--------|------|------|
| WCAG 2.1 A | 必須 | MVP で完全準拠 |
| WCAG 2.1 AA | 必須 | MVP で完全準拠 |
| WCAG 2.1 AAA | 推奨 | 可能な範囲で対応 |

### 1.2 対象環境

- iOS VoiceOver
- Android TalkBack
- 拡大表示（200%まで）
- 色反転モード
- 視差効果を減らす設定

---

## 2. 視覚アクセシビリティ

### 2.1 色のコントラスト

| 要素 | 最小比率 | 備考 |
|------|----------|------|
| 本文テキスト | 4.5:1 | 16pt未満 |
| 大きいテキスト | 3:1 | 18pt以上 or 14pt Bold |
| UI コンポーネント | 3:1 | ボタン、アイコン境界 |
| フォーカスインジケータ | 3:1 | 背景に対して |

### 2.2 色だけに依存しない情報伝達

```
❌ 悪い例
- 赤いアイコン = エラー（色のみで伝達）

✓ 良い例
- 赤いアイコン + ⚠️マーク + テキストラベル
```

### 2.3 テキストサイズ

- 最小フォントサイズ: 11pt（補足テキスト）
- 推奨本文サイズ: 15-17pt
- ユーザー設定による拡大を尊重
- 200% 拡大時もレイアウト崩れなし

---

## 3. 運動・操作アクセシビリティ

### 3.1 タッチターゲット

| 要素 | 最小サイズ | 推奨サイズ |
|------|-----------|-----------|
| ボタン | 44×44pt | 48×48pt |
| リストアイテム | 44pt高 | 48pt高 |
| アイコンボタン | 44×44pt | 48×48pt |
| 間隔 | 8pt | 12pt |

### 3.2 ジェスチャー

| 操作 | 必須代替手段 |
|------|--------------|
| スワイプ | ボタンタップ |
| 長押し | メニューボタン |
| ピンチ | +/- ボタン |
| ドラッグ | タップで選択 → 移動ボタン |

### 3.3 タイムアウト

- 自動タイムアウトなし（または無効化オプション）
- 入力途中データの自動保存
- セッション切れ前の警告

---

## 4. スクリーンリーダー対応

### 4.1 セマンティック構造

```
画面構造:
├─ Header（ナビゲーションランドマーク）
├─ Main（メインコンテンツランドマーク）
│   ├─ Heading Level 1（画面タイトル）
│   ├─ Section
│   │   └─ Heading Level 2
│   └─ Section
│       └─ Heading Level 2
└─ Footer（フッターナビゲーション）
```

### 4.2 読み上げラベル

| 要素 | 必須属性 |
|------|----------|
| ボタン | accessibilityLabel |
| 画像 | accessibilityLabel（装飾以外） |
| アイコン | accessibilityLabel |
| フォーム入力 | accessibilityLabel + accessibilityHint |
| 状態変化 | accessibilityLiveRegion |

### 4.3 読み上げ例

```
// ボタン
accessibilityLabel: "記録を追加"
accessibilityHint: "新しい料理の記録画面を開きます"

// 画像
accessibilityLabel: "2024年1月15日に記録したカレーライス"

// 時間表示
accessibilityLabel: "現在の時間帯: 夕方"

// 空状態
accessibilityLabel: "まだ記録がありません。下の追加ボタンから最初の記録を始められます"
```

### 4.4 2.5D キッチンビュー

| 要素 | 読み上げ方針 |
|------|--------------|
| キッチン全体 | "あなたのキッチン。[N]個の料理が飾られています" |
| 装飾オブジェクト | 装飾としてスキップ（decorative） |
| 時間帯照明 | 読み上げない（視覚演出） |
| インタラクティブ要素 | 個別にラベル付与 |

---

## 5. 聴覚アクセシビリティ

### 5.1 音声に依存しない設計

- すべての音声フィードバックに視覚代替あり
- BGM/環境音はオフ可能
- 重要な通知は視覚と触覚（バイブレーション）

### 5.2 字幕・キャプション

- 動画コンテンツがある場合は字幕必須
- 音声ガイドがある場合はテキスト版も提供

---

## 6. 認知アクセシビリティ

### 6.1 一貫性

- ナビゲーションの位置は全画面で固定
- 同じアイコンは同じ意味
- 同じ操作は同じ結果

### 6.2 エラー防止

| 操作 | 防止策 |
|------|--------|
| 削除 | 確認ダイアログ |
| 破壊的変更 | 元に戻すオプション |
| 長いフォーム | 自動保存 |
| 必須入力 | 事前に明示 |

### 6.3 シンプルな言語

- 専門用語を避ける
- 1文は短く（40文字目安）
- 指示は具体的に

---

## 7. モーション・アニメーション

### 7.1 Reduced Motion 対応

```
if (prefers-reduced-motion) {
  // アニメーションを無効化またはシンプル化
  duration: 0 または instant
  // ただし意味のある遷移は維持
}
```

### 7.2 注意事項

| 許可 | 禁止 |
|------|------|
| フェードイン/アウト | 点滅（3回/秒以上） |
| スライド遷移 | 自動再生ループ動画 |
| 微細なパララックス | 急激な色変化 |
| celebration演出（任意） | 回転・拡縮の連続 |

---

## 8. フォーカス管理

### 8.1 フォーカス順序

1. 論理的な読み順に従う（上→下、左→右）
2. モーダル内にフォーカスをトラップ
3. モーダル閉じたら元の位置に戻る
4. 新しいコンテンツ表示時は適切にフォーカス移動

### 8.2 フォーカスインジケータ

- 2px 以上の太さ
- 背景に対してコントラスト比 3:1 以上
- 見えやすい色（#C17A50 または outline）

---

## 9. テスト要件

### 9.1 自動テスト

| ツール | 対象 |
|--------|------|
| axe-core | コンポーネント単位 |
| Lighthouse | 画面単位 |
| jest-axe | ユニットテスト統合 |

### 9.2 手動テスト

| テスト | 頻度 |
|--------|------|
| VoiceOver 全画面走査 | 画面追加時 |
| TalkBack 全画面走査 | 画面追加時 |
| キーボードナビゲーション | 画面追加時 |
| 200% 拡大表示 | リリース前 |
| 色反転モード | リリース前 |

### 9.3 チェックリスト

MVP リリース前に確認:

- [ ] すべてのインタラクティブ要素が 44×44pt 以上
- [ ] すべてのテキストがコントラスト比 4.5:1 以上
- [ ] すべての画像に代替テキスト
- [ ] すべてのフォームにラベル
- [ ] VoiceOver で全画面操作可能
- [ ] TalkBack で全画面操作可能
- [ ] Reduced Motion 設定が反映される
- [ ] 200% 拡大でレイアウト維持

---

## 10. 参考リソース

- [WCAG 2.1 日本語訳](https://waic.jp/docs/WCAG21/)
- [Apple Accessibility Guidelines](https://developer.apple.com/accessibility/)
- [Android Accessibility](https://developer.android.com/guide/topics/ui/accessibility)
- [Inclusive Components](https://inclusive-components.design/)
